<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XIDZs-WRT</title>
    <link rel="stylesheet" href="<%=media%>/xidz.css">
    <link rel="shortcut icon" href="<%=media%>/favicon.ico">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;transition:all .6s ease}
        body{width:100%;height:100vh;display:flex;justify-content:center;align-items:center;font-family:system-ui;background:var(--bg);color:var(--text)}

        .theme-toggle{position:fixed;top:20px;right:20px;z-index:1000}
        .theme-btn,.login_form_container,.login_form,.input_group,input[type="submit"]{border-radius:20px;border:none}
        .theme-btn{padding:10px 20px;cursor:pointer;font:600 12px inherit;text-transform:uppercase;letter-spacing:1px;background:var(--bg);color:var(--text);box-shadow:var(--shadow-out)}
        .theme-btn:hover{box-shadow:var(--shadow-in);transform:scale(.95)}

        .login_form_container{width:380px;height:480px;border-radius:30px;display:flex;align-items:center;justify-content:center;background:var(--bg);box-shadow:var(--shadow-deep)}
        .login_form{width:calc(100% - 16px);height:calc(100% - 16px);padding:40px;border-radius:25px;background:var(--bg);box-shadow:var(--shadow-in)}

        .alert-message{padding:15px;margin-bottom:20px;border-radius:15px;background:var(--bg);color:var(--text);box-shadow:var(--shadow-out);border-left:3px solid var(--accent);animation:slideDown .5s ease}

        h2{font-size:36px;font-weight:700;text-align:center;margin-bottom:20px;color:var(--text)}
        .date-time{text-align:center;font-size:14px;opacity:.8;margin-bottom:30px;color:var(--muted);font-weight:500}

        .input_group{margin-bottom:20px;background:var(--bg);box-shadow:var(--shadow-in);padding:2px}
        .input_text{width:100%;height:46px;border:none;outline:none;border-radius:13px;font-size:16px;padding:0 20px;background:transparent;color:var(--input)}
        .input_text:focus{transform:scale(1.02)}
        ::placeholder{color:var(--muted);opacity:.6}

        input[type="submit"]{width:100%;height:50px;font:600 18px inherit;letter-spacing:2px;cursor:pointer;margin-top:20px;background:var(--bg);color:var(--accent);box-shadow:var(--shadow-out)}
        input[type="submit"]:hover{box-shadow:var(--shadow-in);color:var(--input);transform:scale(.98)}

        /* Theme Variables */
        :root{--bg:#2d3436;--text:#ddd;--accent:#ffd700;--input:#00fa9a;--muted:#bbb;--shadow-out:8px 8px 16px #1e2123,-8px -8px 16px #3c4649;--shadow-in:inset 4px 4px 8px #1e2123,inset -4px -4px 8px #3c4649;--shadow-deep:20px 20px 40px #1e2123,-20px -20px 40px #3c4649}
        .light{--bg:#f0f2f5;--text:#4a5568;--accent:#6366f1;--input:#2d3748;--muted:#718096;--shadow-out:6px 6px 12px #d0d4d8,-6px -6px 12px #ffffff;--shadow-in:inset 3px 3px 6px #d0d4d8,inset -3px -3px 6px #ffffff;--shadow-deep:15px 15px 30px #d0d4d8,-15px -15px 30px #ffffff}
        .neon{--bg:#1a1a1a;--text:#d4af37;--accent:#ffd700;--input:#b8860b;--muted:#cd853f;--shadow-out:0 0 15px rgba(255,215,0,.3);--shadow-in:inset 0 0 10px rgba(255,215,0,.15);--shadow-deep:0 0 25px rgba(255,215,0,.4)}
        .rose{--bg:#1a1a2e;--text:#e94560;--accent:#e94560;--input:#ff6b9d;--muted:#c73650;--shadow-out:8px 8px 16px #0f0f1a,-8px -8px 16px #252542;--shadow-in:inset 4px 4px 8px #0f0f1a,inset -4px -4px 8px #252542;--shadow-deep:20px 20px 40px #0f0f1a,-20px -20px 40px #252542}

        /* Glass Theme - Complete Transparency */
        .glass{--bg:transparent;--text:#fff;--accent:#fff;--input:#fff;--muted:rgba(255,255,255,.9);--shadow-out:0 8px 32px rgba(0,0,0,.1);--shadow-in:0 2px 16px rgba(255,255,255,.1);--shadow-deep:0 25px 45px rgba(0,0,0,.1)}
        body.glass{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
        .glass *{backdrop-filter:blur(20px)}
        .glass .theme-btn{background:rgba(255,255,255,.15);box-shadow:0 4px 15px rgba(0,0,0,.1)}
        .glass .login_form_container{background:rgba(255,255,255,.08);box-shadow:0 25px 45px rgba(0,0,0,.1)}
        .glass .login_form{background:transparent;box-shadow:none}
        .glass .input_group{background:rgba(255,255,255,.12);box-shadow:none}
        .glass input[type="submit"]{background:rgba(255,255,255,.18);box-shadow:0 4px 15px rgba(0,0,0,.1)}
        .glass input[type="submit"]:hover{background:rgba(255,255,255,.22)}
        
        /* Glass Alert Message - Pure Transparent */
        .glass .alert-message{background:transparent !important;backdrop-filter:none !important;box-shadow:none !important;border:none !important;padding:8px 0;margin-bottom:15px;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.5);font-size:14px;font-weight:600}
        .glass .alert-message p{background:transparent !important;margin:0;line-height:1.3;opacity:.95}
        .glass .alert-message center{background:transparent !important}
        
        /* Glass Text - Perfect Transparency */
        .glass h2{background:transparent;text-shadow:0 2px 4px rgba(0,0,0,.3)}
        .glass .date-time{background:transparent;text-shadow:0 1px 2px rgba(0,0,0,.2)}

        .rgb{--bg:#222;--text:#ddd;--accent:#ff6b9d;--input:#6bcf7f;--muted:#aaa;--shadow-out:8px 8px 16px #111,-8px -8px 16px #333;--shadow-in:inset 4px 4px 8px #111,inset -4px -4px 8px #333;--shadow-deep:20px 20px 40px #111,-20px -20px 40px #333}
        @keyframes moderateRGB{0%{border-color:#cc4444;box-shadow:0 0 8px rgba(204,68,68,.4)}25%{border-color:#44cc44;box-shadow:0 0 8px rgba(68,204,68,.4)}50%{border-color:#4488cc;box-shadow:0 0 8px rgba(68,136,204,.4)}75%{border-color:#cc44cc;box-shadow:0 0 8px rgba(204,68,204,.4)}100%{border-color:#cc4444;box-shadow:0 0 8px rgba(204,68,68,.4)}}
        .rgb .login_form_container,.rgb .input_group,.rgb input[type="submit"]{border:2px solid #cc4444;animation:moderateRGB 4s ease-in-out infinite}

        @media (max-width:768px){.login_form_container{width:90vw;height:70vh;max-width:350px}.login_form{padding:30px}}
        @keyframes slideDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
        .fade-out{animation:slideUp .3s ease forwards}
        @keyframes slideUp{to{opacity:0;transform:translateY(-20px)}}
    </style>
</head>
<body>
    <div class="theme-toggle">
        <button class="theme-btn" id="b">DARK</button>
    </div>

    <form method="post" action="<%=pcdata(FULL_REQUEST_URI)%>">
        <%- if fuser then %>
            <div class="alert-message" id="a">
                <center><p><%:Username Atau Sandi Salah%><br><%:Masukan Dengan Benar%></p></center>
            </div>
        <% end-%>

        <div class="login_form_container">
            <div class="login_form">
                <h2>XIDZs-WRT</h2>
                <div class="date-time">
                    <span id="d"></span> | <span id="t"></span>
                </div>

                <div class="input_group">
                    <input class="input_text" type="text" name="luci_username" placeholder="Username" value="<%=duser%>">
                </div>
                
                <div class="input_group">
                    <input class="input_text" type="password" name="luci_password" placeholder="Password">
                </div>

                <input type="submit" value="LOGIN">
            </div>
        </div>
    </form>

    <script>
        const T=['dark','light','glass','neon','rose','rgb'],B=document.getElementById('b'),D=document.body;
        let C=localStorage.theme||'dark';D.className=C;B.textContent=C.toUpperCase();
        B.onclick=()=>{C=T[(T.indexOf(C)+1)%6];D.className=C;B.textContent=C.toUpperCase();localStorage.theme=C};
        const U=()=>{const N=new Date();document.getElementById('t').textContent=N.toLocaleTimeString('id');if(!document.getElementById('d').textContent)document.getElementById('d').textContent=N.toLocaleDateString('id',{weekday:'long',day:'numeric',month:'short',year:'numeric'})};
        U();setInterval(U,1000);
        const A=document.getElementById('a');if(A)setTimeout(()=>A.classList.add('fade-out'),3000);
        setTimeout(()=>document.getElementsByName('luci_password')[0]?.focus(),500);
    </script>

    <% local uci = require "luci.model.uci".cursor(); local fs = require "nixio.fs"; local https_key = uci:get("uhttpd","main","key"); local https_port = uci:get("uhttpd","main","listen_https"); if type(https_port) == "table" then https_port = https_port[1] end; if https_port and fs.access(https_key) then https_port = https_port:match("(%d+)$") %>
        <script>if (document.location.protocol !== 'https:') { const url = `https://${window.location.hostname}:<%=https_port%>${window.location.pathname}`; const img = new Image(); img.onload = () => window.location = url; img.src = `https://${window.location.hostname}:<%=https_port%>/<%=resource%>/icons/loading.gif?${Math.random()}`; setTimeout(() => img.src = '', 240); }</script>
    <% end %>
</body>
</html>